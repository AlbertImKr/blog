{% extends 'base.html' %}

{% load static %}
{% block css %}

<!-- Favicon -->
<link rel="shortcut icon" href="{% static 'assets/images/favicon.ico' %}">


<!-- Google Font -->
<link rel="preconnect" href="https://fonts.gstatic.com">
<link
    href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@400;700&family=Rubik:wght@400;500;700&display=swap"
    rel="stylesheet">

<!-- Plugins CSS -->
<link rel="stylesheet" type="text/css"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.11.3/font/bootstrap-icons.min.css"
      integrity="sha512-dPXYcDub/aeb08c63jRq/k6GaKccl256JQy/AnOq7CAnEZ9FzSL9wSbcZkMp4R26vBsMLFYH4kQ67/bbV8XaCQ=="
      crossorigin="anonymous" referrerpolicy="no-referrer"/>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/apexcharts/3.52.0/apexcharts.css"
      integrity="sha512-MABOR9SSgAWKoiUTIp5VadLnlvw/Q+UUlX1utgLC/3ul83lxVSia/3Cm0UzQyj1kTHBkN4C9VZrGlImKctYEeA=="
      crossorigin="anonymous" referrerpolicy="no-referrer"/>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/quill/2.0.2/quill.snow.css"
      integrity="sha512-ggYQiYwuFFyThzEv6Eo6g/uPLis4oUynsE88ovEde5b2swycOh9SlAI8FL/cL2AkGGNnWADPXcX2UnPIJS2ozw=="
      crossorigin="anonymous" referrerpolicy="no-referrer"/>
<!-- Theme CSS -->
<link rel="stylesheet" type="text/css" href="{% static 'assets/css/style.css' %}">

{% endblock %}
{% block content %}

<!-- **************** MAIN CONTENT START **************** -->
<main>
    <!-- =======================
    Post list START -->
    <section class="py-4">
        <div class="container">
            <div class="row pb-4">
                <div class="col-12">
                    <!-- Title -->
                    <div class="d-sm-flex justify-content-sm-between align-items-center">
                        <h1 class="mb-2 mb-sm-0 h2">Post List <span class="badge bg-primary bg-opacity-10 text-primary">{{ total_posts }}</span>
                        </h1>
                        <a href="{% url 'post_create' %}" class="btn btn-sm btn-primary mb-0"><i
                            class="fas fa-plus me-2"></i>Add a post</a>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-12">
                    <!-- Post list table START -->
                    <div class="card border bg-transparent rounded-3">

                        <!-- Card body START -->
                        <div class="card-body p-3">

                            <!-- Search and select START -->
                            <div class="row g-3 align-items-center justify-content-between mb-3">
                                <!-- Search -->
                                <div class="col-md-8">
                                    <form class="rounded position-relative">
                                        <input class="form-control pe-5 bg-transparent" type="search"
                                               placeholder="Search" aria-label="Search">
                                        <button
                                            class="btn bg-transparent border-0 px-2 py-0 position-absolute top-50 end-0 translate-middle-y"
                                            type="submit"><i class="fas fa-search fs-6 "></i></button>
                                    </form>
                                </div>

                                <!-- Select option -->
                                <div class="col-md-3">
                                    <!-- Short by filter -->
                                    <form>
                                        <select class="form-select z-index-9 bg-transparent"
                                                aria-label=".form-select-sm">
                                            <option value="">Sort by</option>
                                            <option>Newest</option>
                                            <option>Oldest</option>
                                        </select>
                                    </form>
                                </div>
                            </div>
                            <!-- Search and select END -->

                            <!-- Post list table START -->
                            <div class="table-responsive border-0">
                                <table class="table align-middle p-4 mb-0 table-hover table-shrink">
                                    <!-- Table head -->
                                    <thead class="table-dark">
                                    <tr>
                                        <th scope="col" class="border-0 rounded-start text-center">Post Title</th>
                                        <th scope="col" class="border-0 text-center">Published Date</th>
                                        <th scope="col" class="border-0 text-center">Category</th>
                                        <th scope="col" class="border-0 text-center">Status</th>
                                        <th scope="col" class="border-0 rounded-end text-center">Action</th>
                                    </tr>
                                    </thead>

                                    <!-- Table body START -->
                                    <tbody class="border-top-0">
                                    <!-- Table item -->
                                    {% load category_filters %}
                                    {% for post in page_obj %}
                                    <tr>
                                        <!-- Table data -->
                                        <td>
                                            <h6 class="course-title mt-2 mt-md-0 mb-0 text-center">
                                                <a href="{% url 'post_detail' post.pk%}">
                                                    {{ post.title }}
                                                </a>
                                            </h6>
                                        </td>
                                        <!-- Table data -->
                                        <td class="text-center">{{ post.created_at|date:"M d, Y" }}</td>
                                        <!-- Table data -->
                                        <td>
                                            <div class="d-flex justify-content-center">
                                                <a href="#" class="badge {{ post.category|random_text_bg_color }} mb-2"><i
                                                    class="fas fa-circle me-2 small fw-bold"></i>
                                                    {{ post.category }}
                                                </a>
                                            </div>
                                        </td>
                                        <!-- Table data -->
                                        <td class="text-center">
                                            {% if post.status %}
                                            <span class="badge bg-success bg-opacity-10 text-success mb-2">Live</span>
                                            {% else %}
                                            <span class="badge bg-warning bg-opacity-15 text-warning mb-2">Draft</span>
                                            {% endif %}
                                        </td>
                                        <!-- Table data -->
                                        <td>
                                            <div class="d-flex gap-2 justify-content-center">
                                                <a href="#" class="btn btn-light btn-round mb-0"
                                                   data-bs-toggle="tooltip" data-bs-placement="top" title="Delete"><i
                                                    class="bi bi-trash"></i></a>
                                                <a href="{% url 'post_update' post.pk %}"
                                                   class="btn btn-light btn-round mb-0"
                                                   data-bs-toggle="tooltip" data-bs-placement="top" title="Edit"><i
                                                    class="bi bi-pencil-square"></i></a>
                                            </div>
                                        </td>
                                    </tr>
                                    {% endfor %}
                                    </tbody>
                                    <!-- Table body END -->
                                </table>
                            </div>
                            <!-- Post list table END -->

                            <!-- Pagination START -->
                            <div class="d-sm-flex justify-content-sm-between align-items-sm-center mt-4 mt-sm-3">
                                <!-- Content -->
                                <p class="mb-sm-0 text-center text-sm-start">Page {{ page_obj.number }} of
                                    {{ page_obj.paginator.num_pages }}</p>
                                <!-- Pagination -->
                                <nav class="mb-sm-0 d-flex justify-content-center" aria-label="navigation">
                                    <ul class="pagination pagination-sm pagination-bordered mb-0">
                                        {% if page_obj.has_previous %}
                                        <li class="page-item">
                                            <a class="page-link" href="?page=1">First</a>
                                        </li>
                                        <li class="page-item">
                                            <a class="page-link"
                                               href="?page={{ page_obj.previous_page_number }}">Prev</a>
                                        </li>
                                        {% else %}
                                        <li class="page-item disabled">
                                            <span class="page-link">First</span>
                                        </li>
                                        <li class="page-item disabled">
                                            <span class="page-link">Prev</span>
                                        </li>
                                        {% endif %}
                                        {% if page_obj.number > 2 %}
                                        <li class="page-item">
                                            <a class="page-link" href="?page=">{{ page_obj.number|add:-2 }}</a>
                                        </li>
                                        {% endif %}
                                        {% if page_obj.number > 1 %}
                                        <li class="page-item">
                                            <a class="page-link" href="?page=">{{ page_obj.number|add:-1 }}</a>
                                        </li>
                                        {% endif %}
                                        <li class="page-item active" aria-current="page">
                                            <a class="page-link" href="?page={{ page_obj.number  }}">{{ page_obj.number }}</a>
                                        </li>
                                        {% if page_obj.number < page_obj.paginator.num_pages %}
                                        <li class="page-item">
                                            <a class="page-link" href="?page=">{{ page_obj.number|add:+1 }}</a>
                                        </li>
                                        {% endif %}
                                        {% if page_obj.number < page_obj.paginator.num_pages|add:-1 %}
                                        <li class="page-item">
                                            <a class="page-link" href="?page=">{{ page_obj.number|add:+2 }}</a>
                                        </li>
                                        {% endif %}
                                        {% if page_obj.has_next %}
                                        <li class="page-item">
                                            <a class="page-link" href="?page={{ page_obj.next_page_number }}">Next</a>
                                        </li>
                                        <li class="page-item">
                                            <a class="page-link"
                                               href="?page={{ page_obj.paginator.num_pages }}">Last</a>
                                        </li>
                                        {% else %}
                                        <li class="page-item">
                                            <span class="page-link disabled">Next</span>
                                        </li>
                                        <li class="page-item">
                                            <span class="page-link disabled">Last</span>
                                        </li>
                                        {% endif %}
                                    </ul>
                                </nav>
                            </div>
                            <!-- Pagination END -->
                        </div>
                    </div>
                    <!-- Post list table END -->
                </div>
            </div>
        </div>
    </section>
    <!-- =======================
    Main contain END -->

</main>
<!-- **************** MAIN CONTENT END **************** -->
{% endblock %}
{% block footer %}
<!-- =======================
Footer START -->
<footer class="mb-3">
    {% include 'foot_copyright.html' %}
</footer>
<!-- =======================
Footer END -->
{% endblock %}
{% block scripts %}
<!-- =======================
JS libraries, plugins and custom scripts -->

<!-- Bootstrap JS -->
<script crossorigin="anonymous"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<!-- Vendors -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/apexcharts/3.52.0/apexcharts.min.js"
        integrity="sha512-piY4QAXPoG2xLdUZZbcc5klXzMxckrQKY9A2o6nKDRt9inolvvLbvGPC+z9IZ29b28UJlD05B7CjxxPaxh4bjQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/quill/2.0.2/quill.min.js"
        integrity="sha512-1nmY9t9/Iq3JU1fGf0OpNCn6uXMmwC1XYX9a6547vnfcjCY1KvU9TE5e8jHQvXBoEH7hcKLIbbOjneZ8HCeNLA=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<!-- Template Functions -->
<script src="{% static '/assets/js/functions.js' %}"></script>
{% endblock %}

